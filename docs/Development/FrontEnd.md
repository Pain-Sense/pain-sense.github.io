# FrontEnd

## Start Experiment Page

The **Start Experiment** page allows the configuration and initialization of new experiments through a structured form. The user flow consists of the following steps:

1. **Patient Selection**  
   The user must select a patient previously registered in the system. This step is mandatory to associate the experiment with a specific subject.

2. **Experiment Information**  
   After selecting the patient, the user must:  
   - Define a **name for the experiment** (required field).  
   - Add **additional notes** (optional field), useful for observations, context, or specific parameters.

3. **Device Selection and Validation**  
   The user chooses a device from the available list. Devices can be in one of two states:  
   - **Online:** the device is connected to the network and properly integrated with the system, ready for use.  
   - **Offline:** the device is disconnected or unavailable.  
   Before starting the experiment, the system performs a connection test with the selected device. Only online devices can be used.

4. **Start Experiment**  
   Once a patient is selected, the experiment name is set, and an online device is validated, the **Start Experiment** button becomes active, allowing data collection to begin.

<img src="/img/FrontEnd1.png" alt="Start Experiment Page Screenshot" />

---

## Real-Time Monitoring

After creating an experiment, the user is automatically redirected to the **Real-Time Monitoring** page. This page continuously and dynamically displays data sent by the selected device during the experiment.

### Experiment Information

At the top of the page, key details of the experiment are shown, including:  
- Experiment name  
- Associated patient  
- Additional notes (if provided)  
- Device ID  

### Real-Time Data Visualization

Data captured by the device is shown using real-time updating graphs. The process works as follows:

1. **Dynamic Backend Query**  
   The frontend sends an HTTP request to the backend to identify the types of data being sent (e.g., ECG, GSR, BVP).

2. **Dynamic Graph Construction**  
   Based on the response, the frontend dynamically inserts the appropriate graphs into the React dashboard.

3. **Grafana Integration**  
   Graphs are generated by Grafana, which consumes real-time data stored in InfluxDB. The frontend embeds these graphs via dynamically configured iframes.

This flow ensures the monitoring dashboard adapts automatically to the device’s capabilities, providing accurate and efficient real-time visualization of biometric signals.

<img src="/img/FrontEnd2.png" alt="Real-Time Monitoring Dashboard" />

---

## Device Status Monitoring

During the experiment, the device’s connectivity is constantly monitored to ensure data collection integrity.

A polling mechanism in the frontend sends periodic requests to the backend to check if the device is still online. This continuous check allows near real-time detection of connection loss.

### Disconnection Notifications

If the device goes offline during the experiment:  
- The system automatically detects the disconnection through polling.  
- A notification alerts the user on the interface about the disconnection.  
- This enables the operator to quickly respond by reconnecting, stopping, or restarting the experiment.

This mechanism is essential to ensure data reliability and the safety of real-time monitoring.

<img src="/img/FrontEndDeviceOffline.png" alt="Device Offline Notification" />

---

## History and Post-Experiment Analysis

After the experiment ends, the system allows access to detailed historical data for analysis, interpretation, and support of clinical or scientific decisions.

### History Visualization

Users can view:  
- Basic experiment info (patient, name, notes, device)  
- Historical graphs with raw data sent by the device during the experiment, stored in InfluxDB

### Feature Extraction

In addition to raw data, new graphs are shown based on feature extraction done by the backend, using key signals like:  
- **ECG:** average heart rate, variability  
- **GSR:** average skin conductance, peak events  
- **BVP:** average pulse, amplitude  

These derived graphs are dynamically rendered and help highlight important patterns and metrics in an aggregated way.

### Grafana Integration

Similar to live viewing, historical and feature-extracted graphs are shown through dynamic Grafana dashboards integrated into the React frontend via iframes, automatically configured for the selected experiment.

<img src="/img/FrontEnd3.png" alt="Historical Data Dashboard" />  
<img src="/img/FrontEnd4.png" alt="Feature Extraction Dashboard" />

---

## Experiment Listing

The system also provides a dedicated page listing all recorded experiments. This feature offers an overview and makes it easy to access past experiments for review or analysis.

<img src="/img/FrontEnd5.png" alt="Experiment Listing Page" />
